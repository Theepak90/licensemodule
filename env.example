# ==================== TORRO LICENSE MANAGEMENT SYSTEM ====================
# Copy this file to .env and configure your environment variables

# ==================== SERVER CONFIGURATION ====================
NODE_ENV=development
PORT=3001
HOST=localhost

# ==================== DATABASE CONFIGURATION ====================
MONGODB_URI=mongodb://localhost:27017/torro_licenses
DB_NAME=torro_licenses

# ==================== JWT CONFIGURATION ====================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# ==================== ENCRYPTION CONFIGURATION ====================
LICENSE_ENCRYPTION_KEY=your-32-character-encryption-key-change-this
LICENSE_SALT=military-grade-salt-2024
RSA_PRIVATE_KEY=your-rsa-private-key
RSA_PUBLIC_KEY=your-rsa-public-key

# ==================== MILITARY-GRADE SECURITY ====================
MILITARY_SECURITY_ENABLED=true
HARDWARE_BINDING_REQUIRED=true
ANTI_TAMPERING_ENABLED=true
SELF_DESTRUCTION_ENABLED=true
SECURITY_LEVEL=military

# ==================== KEY ROTATION ====================
KEY_ROTATION_INTERVAL=3600000

# ==================== RISK SCORING WEIGHTS ====================
RISK_WEIGHT_HARDWARE_MISMATCH=30
RISK_WEIGHT_IP_MISMATCH=25
RISK_WEIGHT_GEO_MISMATCH=20
RISK_WEIGHT_DEBUGGER=40
RISK_WEIGHT_INTEGRITY=50
RISK_WEIGHT_HIGH_FREQUENCY=15
MAX_RISK_SCORE=80

# ==================== DEBUGGING & ANTI-TAMPERING ====================
DEBUGGER_THRESHOLD=100

# ==================== INTEGRITY CHECKING ====================
PBKDF2_ITERATIONS=10000
PBKDF2_KEY_LENGTH=64

# ==================== SECURE DELETION ====================
SECURE_DELETE_PASSES=7

# ==================== LOCK FILES ====================
LOCK_FILE_NAME=.license_destroyed
TORRO_LOCK_FILE_NAME=.torro_license_destroyed

# ==================== CRITICAL FILES ====================
CRITICAL_FILES=config.json,database.json,license.json,.env
TORRO_CRITICAL_FILES=config.json,database.json,license.json,.env,package.json,node_modules

# ==================== LICENSE KEY CONFIGURATION ====================
LICENSE_KEY_PREFIX=TORRO
LICENSE_RANDOM_LENGTH=16
LICENSE_CHECKSUM_LENGTH=8
CLIENT_ID_PREFIX=TORRO
CLIENT_ID_SUFFIX_LENGTH=9

# ==================== NETWORK SECURITY ====================
ALLOWED_COUNTRIES=US,CA,GB,DE,FR
MAX_REQUESTS_PER_HOUR=1000
RATE_LIMIT_WINDOW_MS=3600000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_MESSAGE=Too many requests from this IP, please try again later.

# ==================== CORS CONFIGURATION ====================
CORS_ORIGIN=http://localhost:3000,http://localhost:3002
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-Requested-With

# ==================== BODY PARSING ====================
JSON_LIMIT=10mb

# ==================== CRON SCHEDULES ====================
LICENSE_CHECK_CRON=* * * * *
LICENSE_CLEANUP_CRON=0 2 * * *

# ==================== LOGGING CONFIGURATION ====================
SECURITY_LOG_DIR=./logs
SECURITY_LOG_FILE=security.log
VIOLATIONS_LOG_FILE=violations.log
METRICS_FILE=metrics.json
LOG_CLEANUP_INTERVAL=3600000
LOG_RETENTION_DAYS=7

# ==================== CLIENT CONFIGURATION ====================
TORRO_API_URL=http://localhost:3001/api
TORRO_GRACE_PERIOD=300000
TORRO_VALIDATION_INTERVAL=60000
TORRO_MAX_RETRIES=3
TORRO_RETRY_DELAY=5000
TORRO_MILITARY_SALT=torro-military-salt

# ==================== ADMIN CONFIGURATION ====================
ADMIN_EMAIL=admin@torro.com
ADMIN_PASSWORD=secure-admin-password



# ==================== KEY ROTATION DAEMON ====================
KEY_DAEMON_SLEEP_INTERVAL=300000
KEY_DAEMON_ROTATION_INTERVAL=3600000
KEY_STORAGE_PATH=./keys
KEY_HISTORY_PATH=./keys/history
KEY_DAEMON_KEY_LENGTH=32
KEY_DAEMON_ALGORITHM=sha256
KEY_DAEMON_DERIVATION_ROUNDS=10000
KEY_DAEMON_MAX_HISTORY=100
KEY_DAEMON_VALIDATION_ENABLED=true
KEY_DAEMON_INTEGRITY_CHECK=true
KEY_DAEMON_LOG_LEVEL=info
KEY_DAEMON_LOG_FILE=./logs/key-daemon.log

# ==================== HASH VALIDATION ====================
ENABLE_HASH_VALIDATION=true
HASH_VALIDATION_ALGORITHM=sha256
HASH_VALIDATION_SALT=torro-hash-salt-2024
HASH_VALIDATION_ITERATIONS=10000
HASH_VALIDATION_LENGTH=64
HASH_VALIDATION_INTERVAL=30000
MAX_MISMATCH_ATTEMPTS=3
PASSWORD_CHANGE_ON_MISMATCH=true
PASSWORD_LENGTH=32
PASSWORD_COMPLEXITY=high
HASH_STORAGE_PATH=./keys/hashes
PASSWORD_STORAGE_PATH=./keys/passwords
ENABLE_HASH_ROTATION=true
HASH_ROTATION_INTERVAL=3600000
